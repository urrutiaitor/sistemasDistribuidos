package UDPserverCalculatorSimple;

import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class ServerProxy {
	
	public void read (byte[] message, int operation, int[] values) {
		char c;
		String strIn = "";
		int initIndex = 0;
		int finalIndex = 0;
		
		while (message[initIndex] != '$') initIndex++;
		
		finalIndex = initIndex;
		
		while (message[finalIndex] != '$') finalIndex++;
		
		String pureMessage = new String(message, initIndex, finalIndex - initIndex);
		
		String[] comp = pureMessage.split("%");
		
		switch (comp[0]) {
		case "gcd":
			operation = 0;
			values[0] = Integer.valueOf(comp[1]);
			values[1] = Integer.valueOf(comp[2]);
			break;
		case "factorial":
			operation = 1;
			values[0] = Integer.valueOf(comp[1]);
			break;

		default:
			System.err.println("Connection closed");
			return;
		}
		
		strIn = "";
	}
	
	public void write (int userId, int type, int answer, String message) {
		String typeString = null;
		
		switch (type) {
		case 0:
			typeString = "gcd";
			break;
		case 1:
			typeString = "factorial";
			break;

		default:
			break;
		}
		
		message = "$" + userId + "%" + typeString + "%" + answer + "$";
	}

}
